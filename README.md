---
# E-Maintenance Scheduler

## Overview
The E-Maintenance Scheduler is a background service built to automate the generation and dispatch of maintenance schedules via email. It operates on a Node.js platform and utilizes various technologies such as Express, Winston, ExcelJS, Node Mailer, Node-Cron, and Sequelize. This service runs every Saturday at 11:59 PM, querying maintenance data from a database, converting it into an Excel file, and then sending it to a designated email address.

## Features
- **Automated Scheduling**: The service automatically runs every Saturday at 11:59 PM without manual intervention.
- **Database Integration**: Utilizes Sequelize to interact with the database and fetch maintenance data.
- **Excel File Generation**: Converts fetched maintenance data into an Excel file using ExcelJS.
- **Email Notification**: Sends the generated Excel file as an attachment to a predefined email address via Node Mailer.
- **Logging**: Utilizes Winston for logging to track the execution and any potential errors.

## Technologies Used
- **Node.js**: JavaScript runtime environment for executing server-side code.
- **Express**: Web application framework for Node.js used for routing.
- **Winston**: Logging library for Node.js used for logging purposes.
- **ExcelJS**: Library for creating and manipulating Excel files.
- **Node Mailer**: Nodemailer is a module for Node.js applications to allow email sending.
- **Node-Cron**: Cron jobs for Node.js.
- **Sequelize**: Promise-based Node.js ORM for PostgreSQL, MySQL, MariaDB, SQLite, and Microsoft SQL Server.

## Setup Instructions
1. **Clone the Repository**: Clone the repository to your local machine.
   ```bash
   git clone https://github.com/bakare-dev/e-maintenance-scheduler.git
   ```
2. **Install Dependencies**: Navigate to the project directory and install the required dependencies using npm.
   ```bash
   cd e-maintenance-scheduler
   npm install
   ```
3. **Configure Environment Variables**: Set up environment variables for database connection details, email configuration, and other settings. Create a `.env` file in the root directory and add the necessary variables.
   ```plaintext
    PORT=
    DEV_DB=
    DEV_USER=
    DEV_PASSWORD=
    DEV_HOST=
    WINSTONSOURCETOKEN=
    WINSTONSOURCEID=
    SMTP_HOST=
    SMTP_PORT=
    SMTP_USN=
    SMTP_PASSWORD=
    ADMIN_EMAIL=
    SUPPORT_EMAIL=
   ```
4. **Run the Service**: Start the service by running the following command.
   ```bash
   npm start
   ```
5. **Monitor Logs**: Monitor the logs generated by Winston to ensure the service is running smoothly.

## Contribution Guidelines
If you would like to contribute to this project, please follow these guidelines:
- Fork the repository and create a new branch for your feature or bug fix.
- Ensure your code adheres to the project's coding style and guidelines.
- Test your changes thoroughly before submitting a pull request.
- Provide detailed information about the changes in the pull request description. 

## Initial Setup Instructions for Development Environment
- On the first run, go to `main.js` and comment out:
  ```javascript
  let server = new Server(config.server.port);
  server.start();
  ```
  and uncomment:
  ```javascript
  let db = new DatabaseEngine();
  db.connect(async() => {
    let server = new Server(config.server.port);
    server.start();
  });
  ```
- Go to `config/main.settings.js`, update `infrastructure.timezone` to your timezone.
- Run `npm start`. After the app starts, shut it down.
- Go back to `main.js` and revert the changes.
- Run `npm start`.

- In the development environment, use `npm run dev`.
```

## Issue Tracker
If you encounter any issues or have suggestions for improvements, please raise them [here](https://github.com/bakare-dev/e-maintenance-scheduler/issues/new/choose). We're open to learning and improving!
